<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Escala de Professores — Fev-Mai 2026</title>
  <link rel="stylesheet" href="../templates/design-tokens-dark-premium.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      font-family: var(--font-sans);
      background: var(--color-bg-page);
      color: var(--color-text-body);
      min-height: 100vh;
    }

    /* ── HEADER ── */
    .page-header {
      background: var(--color-bg-card);
      border-bottom: 1px solid var(--color-border-card);
      padding: 24px 32px;
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(12px);
    }
    .header-inner {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 24px;
      flex-wrap: wrap;
    }
    .header-title {
      display: flex;
      align-items: center;
      gap: 14px;
    }
    .header-icon {
      width: 42px; height: 42px;
      background: linear-gradient(135deg, #6366f1, #8b5cf6);
      border-radius: 10px;
      display: flex; align-items: center; justify-content: center;
      color: #fff; font-size: 20px; flex-shrink: 0;
    }
    .header-text h1 {
      font-size: 20px; font-weight: 700;
      color: var(--color-text-headline);
      line-height: 1.2;
    }
    .header-text p {
      font-size: 13px; color: #666; margin-top: 2px;
    }
    .header-stats {
      display: flex; gap: 20px; flex-wrap: wrap;
    }
    .stat-pill {
      background: var(--color-bg-card-alt);
      border: 1px solid var(--color-border-card);
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 12px;
      display: flex; align-items: center; gap: 6px;
    }
    .stat-pill strong { color: var(--color-text-headline); }
    .link-pill {
      background: rgba(99,102,241,0.12);
      border: 1px solid rgba(99,102,241,0.25);
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 12px;
      display: flex; align-items: center; gap: 6px;
      color: #a5b4fc; font-weight: 600;
      text-decoration: none; transition: all 0.15s;
    }
    .link-pill:hover { background: rgba(99,102,241,0.2); border-color: rgba(99,102,241,0.4); }
    .link-pill i { width: 14px; height: 14px; }

    /* ── LAYOUT ── */
    .layout {
      display: flex;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 32px 64px;
      gap: 32px;
    }

    /* ── SIDEBAR ── */
    .sidebar {
      width: 240px;
      flex-shrink: 0;
      padding-top: 32px;
      position: sticky;
      top: 90px;
      height: calc(100vh - 90px);
      overflow-y: auto;
    }
    .sidebar::-webkit-scrollbar { width: 4px; }
    .sidebar::-webkit-scrollbar-track { background: transparent; }
    .sidebar::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
    .sidebar-label {
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #444;
      margin-bottom: 12px;
      padding: 0 4px;
    }
    .nav-item {
      display: flex; align-items: center; justify-content: space-between;
      padding: 9px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.15s;
      margin-bottom: 2px;
      text-decoration: none;
      color: #888;
      font-size: 13px;
    }
    .nav-item:hover { background: var(--color-bg-card-alt); color: #ccc; }
    .nav-item.active { background: rgba(99,102,241,0.12); color: #a5b4fc; }
    .nav-item-name { font-weight: 500; }
    .nav-count {
      font-size: 11px;
      background: var(--color-bg-card-alt);
      border-radius: 999px;
      padding: 2px 7px;
      color: #555;
      white-space: nowrap;
    }
    .nav-item.active .nav-count { background: rgba(99,102,241,0.2); color: #818cf8; }

    /* ── MAIN ── */
    .main {
      flex: 1;
      min-width: 0;
      padding-top: 32px;
    }

    /* ── FILTER BAR ── */
    .filter-bar {
      display: flex; gap: 8px; flex-wrap: wrap;
      margin-bottom: 28px;
    }
    .filter-btn {
      display: flex; align-items: center; gap: 6px;
      padding: 7px 14px;
      border-radius: 999px;
      border: 1px solid var(--color-border-card);
      background: var(--color-bg-card);
      color: #666;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
      font-family: var(--font-sans);
    }
    .filter-btn .dot {
      width: 8px; height: 8px;
      border-radius: 50%;
    }
    .filter-btn:hover { color: #ccc; border-color: #333; }
    .filter-btn.active { color: var(--color-text-headline); border-color: #444; background: var(--color-bg-card-alt); }

    /* ── TEACHER CARD ── */
    .teacher-card {
      background: var(--color-bg-card);
      border: 1px solid var(--color-border-card);
      border-radius: 14px;
      margin-bottom: 20px;
      overflow: hidden;
      scroll-margin-top: 100px;
    }
    .teacher-card-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--color-border-card);
      display: flex; align-items: center; gap: 16px;
    }
    .teacher-avatar {
      width: 44px; height: 44px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 17px; font-weight: 700;
      color: #fff;
      flex-shrink: 0;
    }
    .teacher-info { flex: 1; min-width: 0; }
    .teacher-name {
      font-size: 17px; font-weight: 700;
      color: var(--color-text-headline);
    }
    .teacher-role {
      font-size: 12px; color: #555;
      margin-top: 2px;
    }
    .teacher-total {
      background: var(--color-bg-card-alt);
      border: 1px solid var(--color-border-card);
      border-radius: 8px;
      padding: 8px 14px;
      text-align: center;
      flex-shrink: 0;
    }
    .teacher-total-num {
      font-size: 22px; font-weight: 800;
      color: var(--color-text-headline);
      line-height: 1;
    }
    .teacher-total-label {
      font-size: 10px; color: #444;
      margin-top: 2px;
    }

    /* ── ASSIGNMENTS ── */
    .assignments { padding: 20px 24px; display: flex; flex-direction: column; gap: 16px; }
    .assignment {
      background: var(--color-bg-card-alt);
      border: 1px solid var(--color-border-card);
      border-left-width: 3px;
      border-radius: 10px;
      padding: 16px;
    }
    .assignment-header {
      display: flex; align-items: center; gap: 10px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }
    .assignment-course {
      font-size: 14px; font-weight: 600;
      color: var(--color-text-headline);
    }
    .role-badge {
      font-size: 10px; font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      padding: 3px 9px;
      border-radius: 999px;
    }
    .role-prof {
      background: rgba(99,102,241,0.15);
      color: #a5b4fc;
    }
    .role-host {
      background: rgba(255,255,255,0.06);
      color: #666;
    }
    .assignment-schedule {
      font-size: 11px; color: #555;
      margin-bottom: 12px;
    }

    /* ── DATE CHIPS ── */
    .dates-grid {
      display: flex; flex-wrap: wrap; gap: 6px;
    }
    .date-chip {
      font-size: 11px; font-weight: 600;
      padding: 4px 10px;
      border-radius: 6px;
      border: 1px solid transparent;
      transition: all 0.15s;
      white-space: nowrap;
    }
    .date-chip.past {
      background: transparent;
      border-color: #1e1e1e;
      color: #333;
      text-decoration: line-through;
    }
    .date-chip.today {
      color: #fff;
      font-weight: 800;
      font-size: 12px;
    }
    .date-chip.future {
      background: rgba(255,255,255,0.04);
      border-color: #2a2a2a;
      color: #888;
    }
    .date-chip.future:hover {
      background: rgba(255,255,255,0.08);
      color: #bbb;
    }

    /* ── LEGEND ── */
    .legend {
      display: flex; gap: 20px; flex-wrap: wrap;
      margin-bottom: 28px;
      padding: 16px 20px;
      background: var(--color-bg-card);
      border: 1px solid var(--color-border-card);
      border-radius: 10px;
    }
    .legend-item {
      display: flex; align-items: center; gap: 6px;
      font-size: 12px; color: #555;
    }
    .legend-dot {
      width: 10px; height: 10px; border-radius: 50%;
    }
    .legend-today { background: #6366f1; box-shadow: 0 0 6px rgba(99,102,241,0.5); }
    .legend-past { background: #222; border: 1px solid #333; }
    .legend-future { background: rgba(255,255,255,0.08); border: 1px solid #2a2a2a; }

    /* ── EMPTY STATE ── */
    .empty-state {
      text-align: center; padding: 60px 24px;
      color: #444; font-size: 14px;
    }

    @media (max-width: 900px) {
      .sidebar { display: none; }
      .layout { padding: 0 16px 48px; }
    }
    @media (max-width: 600px) {
      .page-header { padding: 16px; }
      .header-inner { gap: 12px; }
      .assignments { padding: 16px; }
      .teacher-card-header { padding: 16px; }
    }
  </style>
</head>
<body>

<!-- HEADER -->
<header class="page-header">
  <div class="header-inner">
    <div class="header-title">
      <div class="header-icon"><i data-lucide="clipboard-list" style="width:20px;height:20px;color:#fff"></i></div>
      <div class="header-text">
        <h1>Escala de Professores e Hosts</h1>
        <p>Cronograma individual por mentor — Fevereiro a Maio 2026</p>
      </div>
    </div>
    <div class="header-stats">
      <div class="stat-pill"><strong>15</strong> mentores</div>
      <div class="stat-pill" id="total-sessions-pill">calculando...</div>
      <div class="stat-pill" id="today-pill">calculando...</div>
      <a href="/" class="link-pill"><i data-lucide="home"></i> Home</a>
      <a href="/calendario" class="link-pill"><i data-lucide="calendar"></i> Ver Calendário</a>
    </div>
  </div>
</header>

<!-- LAYOUT -->
<div class="layout">

  <!-- SIDEBAR -->
  <nav class="sidebar">
    <div class="sidebar-label">Mentores</div>
    <div id="nav-list"></div>
  </nav>

  <!-- MAIN -->
  <main class="main">

    <!-- FILTER BAR -->
    <div class="filter-bar" id="filter-bar">
      <button class="filter-btn active" data-filter="all" onclick="setFilter('all')">
        Todos
      </button>
      <button class="filter-btn" data-filter="ps-advanced" onclick="setFilter('ps-advanced')">
        <span class="dot" style="background:#6366f1"></span>PS Advanced
      </button>
      <button class="filter-btn" data-filter="ps-fund" onclick="setFilter('ps-fund')">
        <span class="dot" style="background:#f59e0b"></span>PS Fundamentals
      </button>
      <button class="filter-btn" data-filter="aulas-advanced" onclick="setFilter('aulas-advanced')">
        <span class="dot" style="background:#10b981"></span>Aulas Advanced
      </button>
      <button class="filter-btn" data-filter="aulas-fund" onclick="setFilter('aulas-fund')">
        <span class="dot" style="background:#06b6d4"></span>Aulas Fund
      </button>
      <button class="filter-btn" data-filter="aios-fund" onclick="setFilter('aios-fund')">
        <span class="dot" style="background:#ec4899"></span>Fund T2
      </button>
    </div>

    <!-- LEGEND -->
    <div class="legend">
      <div class="legend-item">
        <div class="legend-dot legend-today"></div>Hoje
      </div>
      <div class="legend-item">
        <div class="legend-dot legend-past"></div>Passado
      </div>
      <div class="legend-item">
        <div class="legend-dot legend-future"></div>Futuro
      </div>
    </div>

    <!-- CARDS -->
    <div id="cards-container"></div>

  </main>
</div>

<script>
// ── COURSE CONFIG ──
const COURSE_CONFIG = {
  'ps-advanced':    { color: '#6366f1', label: 'PS Advanced' },
  'ps-fund':        { color: '#f59e0b', label: 'PS Fundamentals' },
  'aulas-advanced': { color: '#10b981', label: 'Adv T1/T2' },
  'aulas-fund':     { color: '#06b6d4', label: 'Fund T1/T2/T3' },
  'aios-fund':      { color: '#ec4899', label: 'Fund T2' },
};

const COURSE_SHORT = {
  'PS Advanced T1':    'PS Adv T1',
  'PS Advanced T2':    'PS Adv T2',
  'PS Advanced T1+T2': 'PS Adv',
  'PS Fundamentals':   'PS Fund',
  'Aulas Advanced T1': 'Adv T1',
  'Aulas Advanced T2': 'Adv T2',
  'Aulas Fund T1':     'Fund T1',
  'Aulas Fund T2':     'Fund T2',
  'Aulas Fund T3':     'Fund T3',
  'AIOS Fundamentals': 'Fund T2',
  'AIOS Fund (Manhã)': 'Fund T2 Manhã',
  'AIOS Fund (Tarde)': 'Fund T2 Tarde',
};
function shortName(course) { return COURSE_SHORT[course] || course; }

function getCourseType(courseName) {
  const c = courseName.toLowerCase();
  if (c.includes('ps advanced') || c.includes('ps advanced')) return 'ps-advanced';
  if (c.includes('ps fundamental') || c.includes('ps fund')) return 'ps-fund';
  if (c.includes('aulas advanced')) return 'aulas-advanced';
  if (c.includes('aulas fund')) return 'aulas-fund';
  if (c.includes('aios fund') || c.includes('aios fundamental')) return 'aios-fund';
  return 'ps-advanced';
}

// ── TEACHER DATA ──
const TEACHERS = [
  {
    name: "Talles", total: 45,
    role: "Professor (PS Advanced) + Host (Aulas Advanced T1/T2)",
    assignments: [
      { course: "PS Advanced T1", role: "Professor", schedule: "Ter e Sex | 18h-20h | 12 encontros",
        dates: ["24/02","27/02","03/03","06/03","10/03","13/03","17/03","20/03","24/03","27/03","31/03","03/04"] },
      { course: "PS Advanced T2", role: "Professor", schedule: "Ter e Sex | 18h-20h | 16 encontros",
        dates: ["07/04","10/04","14/04","17/04","21/04","24/04","28/04","01/05","05/05","08/05","12/05","15/05","19/05","22/05","26/05","29/05"] },
      { course: "Aulas Advanced T1", role: "Host", schedule: "Quartas | 18h-20h | 9 encontros",
        dates: ["04/02","11/02","18/02","25/02","04/03","11/03","18/03","25/03","01/04"] },
      { course: "Aulas Advanced T2", role: "Host", schedule: "Quartas | 18h-20h | 8 encontros",
        dates: ["08/04","15/04","22/04","29/04","06/05","13/05","20/05","27/05"] },
    ]
  },
  {
    name: "José Amorim", total: 33,
    role: "Professor (PS Advanced + Aulas Fund T1/T3 + AIOS Fund)",
    assignments: [
      { course: "PS Advanced T1", role: "Professor", schedule: "Sextas | 18h-20h | 6 encontros",
        dates: ["27/02","06/03","13/03","20/03","27/03","03/04"] },
      { course: "PS Advanced T2", role: "Professor", schedule: "Sextas | 18h-20h | 8 encontros",
        dates: ["10/04","17/04","24/04","01/05","08/05","15/05","22/05","29/05"] },
      { course: "Aulas Fund T1", role: "Professor", schedule: "Qui e Seg | 18h-20h | 7 encontros",
        dates: ["12/02","16/02","19/02","23/02","26/02","02/03","05/03"] },
      { course: "Aulas Fund T3", role: "Professor", schedule: "Ter e Qui | 18h-20h | 8 encontros",
        dates: ["03/03","05/03","10/03","12/03","17/03","19/03","24/03","26/03"] },
      { course: "AIOS Fundamentals", role: "Professor", schedule: "Sábados | 09h-12h / 14h-16h | 4 encontros",
        dates: ["21/02","28/02","07/03","14/03"] },
    ]
  },
  {
    name: "Klaus", total: 14,
    role: "Professor (PS Advanced T1+T2)",
    assignments: [
      { course: "PS Advanced T1+T2", role: "Professor", schedule: "Terças | 18h-20h | 14 encontros",
        dates: ["24/02","03/03","10/03","17/03","24/03","31/03","07/04","14/04","21/04","28/04","05/05","12/05","19/05","26/05"] },
    ]
  },
  {
    name: "Day", total: 14,
    role: "Professor (PS Advanced T1+T2)",
    assignments: [
      { course: "PS Advanced T1+T2", role: "Professor", schedule: "Terças | 18h-20h | 14 encontros",
        dates: ["24/02","03/03","10/03","17/03","24/03","31/03","07/04","14/04","21/04","28/04","05/05","12/05","19/05","26/05"] },
    ]
  },
  {
    name: "Sidney", total: 11,
    role: "Professor (PS Fundamentals) + Host (AIOS Fund)",
    assignments: [
      { course: "PS Fundamentals", role: "Professor", schedule: "Ter e Sex | 18h-20h | 7 encontros",
        dates: ["17/02","20/02","03/03","06/03","13/03","20/03","27/03"] },
      { course: "AIOS Fund (Manhã)", role: "Host", schedule: "Sábados | 09h-12h | 4 encontros",
        dates: ["21/02","28/02","07/03","14/03"] },
    ]
  },
  {
    name: "Feldman", total: 6,
    role: "Professor (PS Fundamentals)",
    assignments: [
      { course: "PS Fundamentals", role: "Professor", schedule: "Ter e Sex | 18h-20h | 6 encontros",
        dates: ["13/02","24/02","27/02","10/03","17/03","24/03"] },
    ]
  },
  {
    name: "Bruno Gentil", total: 17,
    role: "Professor (PS Fundamentals) + Host (AIOS Fund)",
    assignments: [
      { course: "PS Fundamentals", role: "Professor", schedule: "Ter e Sex | 18h-20h | 13 encontros",
        dates: ["13/02","17/02","20/02","24/02","27/02","03/03","06/03","10/03","13/03","17/03","20/03","24/03","27/03"] },
      { course: "AIOS Fund (Tarde)", role: "Host", schedule: "Sábados | 14h-16h | 4 encontros",
        dates: ["21/02","28/02","07/03","14/03"] },
    ]
  },
  {
    name: "Diego", total: 14,
    role: "Professor (PS Fundamentals) + Host (Aulas Fund T1/T3)",
    assignments: [
      { course: "PS Fundamentals", role: "Professor", schedule: "Terças | 18h-20h | 6 encontros",
        dates: ["17/02","24/02","03/03","10/03","17/03","24/03"] },
      { course: "Aulas Fund T1", role: "Host", schedule: "Quintas | 18h-20h | 4 encontros",
        dates: ["12/02","19/02","26/02","05/03"] },
      { course: "Aulas Fund T3", role: "Host", schedule: "Quintas | 18h-20h | 4 encontros",
        dates: ["05/03","12/03","19/03","26/03"] },
    ]
  },
  {
    name: "Daniel", total: 11,
    role: "Professor (PS Fundamentals) + Host (Aulas Fund T3)",
    assignments: [
      { course: "PS Fundamentals", role: "Professor", schedule: "Sextas | 18h-20h | 7 encontros",
        dates: ["13/02","20/02","27/02","06/03","13/03","20/03","27/03"] },
      { course: "Aulas Fund T3", role: "Host", schedule: "Terças | 18h-20h | 4 encontros",
        dates: ["03/03","10/03","17/03","24/03"] },
    ]
  },
  {
    name: "Adavio", total: 22,
    role: "Professor (PS Advanced T1+T2) + Host (Aulas Advanced T2)",
    assignments: [
      { course: "PS Advanced T1+T2", role: "Professor", schedule: "Sextas | 18h-20h | 14 encontros",
        dates: ["27/02","06/03","13/03","20/03","27/03","03/04","10/04","17/04","24/04","01/05","08/05","15/05","22/05","29/05"] },
      { course: "Aulas Advanced T2", role: "Host", schedule: "Quartas | 18h-20h | 8 encontros",
        dates: ["08/04","15/04","22/04","29/04","06/05","13/05","20/05","27/05"] },
    ]
  },
  {
    name: "Alan Nicolas", total: 9,
    role: "Professor (Aulas Advanced T1)",
    assignments: [
      { course: "Aulas Advanced T1", role: "Professor", schedule: "Quartas | 18h-20h | 9 encontros",
        dates: ["04/02","11/02","18/02","25/02","04/03","11/03","18/03","25/03","01/04"] },
    ]
  },
  {
    name: "Adriano", total: 17,
    role: "Professor (Aulas Advanced T2) + Host (Aulas Advanced T1)",
    assignments: [
      { course: "Aulas Advanced T1", role: "Host", schedule: "Quartas | 18h-20h | 9 encontros",
        dates: ["04/02","11/02","18/02","25/02","04/03","11/03","18/03","25/03","01/04"] },
      { course: "Aulas Advanced T2", role: "Professor", schedule: "Quartas | 18h-20h | 8 encontros",
        dates: ["08/04","15/04","22/04","29/04","06/05","13/05","20/05","27/05"] },
    ]
  },
  {
    name: "Fran", total: 3,
    role: "Host (Aulas Fund T1)",
    assignments: [
      { course: "Aulas Fund T1", role: "Host", schedule: "Segundas | 18h-20h | 3 encontros",
        dates: ["16/02","23/02","02/03"] },
    ]
  },
  {
    name: "Douglas", total: 8,
    role: "Host (Aulas Fund T3)",
    assignments: [
      { course: "Aulas Fund T3", role: "Host", schedule: "Ter e Qui | 18h-20h | 8 encontros",
        dates: ["03/03","05/03","10/03","12/03","17/03","19/03","24/03","26/03"] },
    ]
  },
  {
    name: "Lucas Charão", total: 7,
    role: "Host (Aulas Fund T1)",
    assignments: [
      { course: "Aulas Fund T1", role: "Host", schedule: "Qui e Seg | 18h-20h | 7 encontros",
        dates: ["12/02","16/02","19/02","23/02","26/02","02/03","05/03"] },
    ]
  },
];

// ── DATE UTILITIES ──
function parseDate(ddmm) {
  const [d, m] = ddmm.split('/').map(Number);
  return new Date(2026, m - 1, d);
}

function getDateState(ddmm) {
  const today = new Date(); today.setHours(0,0,0,0);
  const date = parseDate(ddmm); date.setHours(0,0,0,0);
  if (date.getTime() === today.getTime()) return 'today';
  if (date < today) return 'past';
  return 'future';
}

function getInitials(name) {
  return name.split(' ').map(w => w[0]).slice(0, 2).join('').toUpperCase();
}

function getAvatarColor(name) {
  const colors = ['#6366f1','#10b981','#f59e0b','#ec4899','#06b6d4','#8b5cf6','#ef4444','#14b8a6','#f97316','#a855f7'];
  let h = 0; for (const c of name) h = (h * 31 + c.charCodeAt(0)) % colors.length;
  return colors[h];
}

function getNextDate(assignments) {
  const today = new Date(); today.setHours(0,0,0,0);
  let next = null;
  for (const a of assignments) {
    for (const d of a.dates) {
      const date = parseDate(d); date.setHours(0,0,0,0);
      if (date >= today && (!next || date < next)) next = date;
    }
  }
  if (!next) return null;
  return `${String(next.getDate()).padStart(2,'0')}/${String(next.getMonth()+1).padStart(2,'0')}`;
}

// ── CURRENT FILTER ──
let currentFilter = 'all';

function setFilter(filter) {
  currentFilter = filter;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.toggle('active', b.dataset.filter === filter));
  renderCards();
}

// ── RENDER ──
function slugify(name) { return name.toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, ''); }

function renderNav() {
  const nav = document.getElementById('nav-list');
  nav.innerHTML = TEACHERS.map(t => `
    <a class="nav-item" href="#teacher-${slugify(t.name)}" id="nav-${slugify(t.name)}">
      <span class="nav-item-name">${t.name}</span>
      <span class="nav-count">${t.total}</span>
    </a>
  `).join('');
}

function renderCards() {
  const container = document.getElementById('cards-container');
  let filtered = TEACHERS;
  if (currentFilter !== 'all') {
    filtered = TEACHERS.filter(t =>
      t.assignments.some(a => getCourseType(a.course) === currentFilter)
    );
  }

  if (!filtered.length) {
    container.innerHTML = '<div class="empty-state">Nenhum mentor para este filtro.</div>';
    return;
  }

  container.innerHTML = filtered.map(t => {
    const color = getAvatarColor(t.name);
    const nextDate = getNextDate(t.assignments);
    const assignments = t.assignments.filter(a =>
      currentFilter === 'all' || getCourseType(a.course) === currentFilter
    );

    return `
    <div class="teacher-card" id="teacher-${slugify(t.name)}">
      <div class="teacher-card-header">
        <div class="teacher-avatar" style="background:${color}">${getInitials(t.name)}</div>
        <div class="teacher-info">
          <div class="teacher-name">${t.name}</div>
          <div class="teacher-role">${t.role}</div>
          ${nextDate ? `<div style="font-size:11px;color:#555;margin-top:4px">Próximo encontro: <span style="color:#888;font-weight:600">${nextDate}</span></div>` : '<div style="font-size:11px;color:#333;margin-top:4px">Todos os encontros concluídos</div>'}
        </div>
        <div class="teacher-total">
          <div class="teacher-total-num">${t.total}</div>
          <div class="teacher-total-label">encontros</div>
        </div>
      </div>
      <div class="assignments">
        ${assignments.map(a => renderAssignment(a)).join('')}
      </div>
    </div>
    `;
  }).join('');
}

function renderAssignment(a) {
  const type = getCourseType(a.course);
  const cfg = COURSE_CONFIG[type];
  const roleBadge = a.role === 'Professor'
    ? `<span class="role-badge role-prof">Professor</span>`
    : `<span class="role-badge role-host">Host</span>`;

  const chips = a.dates.map(d => {
    const state = getDateState(d);
    let style = '';
    if (state === 'today') style = `background:${cfg.color};box-shadow:0 0 12px ${cfg.color}66;color:#fff;`;
    else if (state === 'future') style = `border-color:${cfg.color}33;`;
    return `<span class="date-chip ${state}" style="${style}">${d}</span>`;
  }).join('');

  return `
  <div class="assignment" style="border-left-color:${cfg.color}">
    <div class="assignment-header">
      <span class="assignment-course">${shortName(a.course)}</span>
      ${roleBadge}
    </div>
    <div class="assignment-schedule">${a.schedule}</div>
    <div class="dates-grid">${chips}</div>
  </div>
  `;
}

function renderStats() {
  const totalSessions = TEACHERS.reduce((sum, t) => sum + t.total, 0);
  document.getElementById('total-sessions-pill').innerHTML = `<strong>${totalSessions}</strong> encontros escalados`;

  // Find today's sessions
  const today = new Date(); today.setHours(0,0,0,0);
  const todayStr = `${String(today.getDate()).padStart(2,'0')}/${String(today.getMonth()+1).padStart(2,'0')}`;
  const todayMentors = TEACHERS.filter(t => t.assignments.some(a => a.dates.includes(todayStr)));
  if (todayMentors.length > 0) {
    document.getElementById('today-pill').innerHTML = `Hoje: <strong>${todayMentors.map(t => t.name).join(', ')}</strong>`;
  } else {
    document.getElementById('today-pill').innerHTML = `Sem sessão hoje`;
  }
}

// ── INIT ──
renderNav();
renderCards();
renderStats();

// Active nav on scroll
const observer = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if (e.isIntersecting) {
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      const id = e.target.id.replace('teacher-', '');
      const nav = document.getElementById(`nav-${id}`);
      if (nav) nav.classList.add('active');
    }
  });
}, { rootMargin: '-20% 0px -70% 0px' });

setTimeout(() => {
  document.querySelectorAll('.teacher-card').forEach(c => observer.observe(c));
}, 100);
</script>
<script src="https://unpkg.com/lucide@latest"></script>
<script>lucide.createIcons();</script>
</body>
</html>
